# 附录 B - 运算符和符号

本附录包含 Cairo 语法的词汇表，包括运算符和其他独自出现或是出现在路径、泛型、宏、属性、注释、元组和括号上下文中的符号。

## 运算符

表 B-1 包含 Cairo 中的运算符、运算符在上下文中的示例、简短解释以及该运算符是否可重载。如果运算符是可重载的，则列出了用于重载该运算符的相关 trait。

| 运算符                    | 示例                                                    | 解释                                     | 可重载?       |
| ------------------------- | ------------------------------------------------------- | ---------------------------------------- | ------------- |
| `!`                       | `!expr`                                                 | 逻辑非                                   | `Not`         |
| `~`                       | `~expr`                                                 | 按位非 (NOT)                             | `BitNot`      |
| `!=`                      | `expr != expr`                                          | 不等于比较                               | `PartialEq`   |
| `%`                       | `expr % expr`                                           | 算术取余                                 | `Rem`         |
| `%=`                      | `var %= expr`                                           | 算术取余并赋值                           | `RemEq`       |
| `&`                       | `expr & expr`                                           | 按位与 (AND)                             | `BitAnd`      |
| `&&`                      | `expr && expr`                                          | 短路逻辑与 (AND)                         |               |
| `*`                       | `expr * expr`                                           | 算术乘法                                 | `Mul`         |
| `*=`                      | `var *= expr`                                           | 算术乘法并赋值                           | `MulEq`       |
| `@`                       | `@var`                                                  | 快照 (Snapshot)                          |               |
| `*`                       | `*var`                                                  | 解快照 (Desnap)                          |               |
| `+`                       | `expr + expr`                                           | 算术加法                                 | `Add`         |
| `+=`                      | `var += expr`                                           | 算术加法并赋值                           | `AddEq`       |
| `,`                       | `expr, expr`                                            | 参数和元素分隔符                         |               |
| `-`                       | `-expr`                                                 | 算术取反                                 | `Neg`         |
| `-`                       | `expr - expr`                                           | 算术减法                                 | `Sub`         |
| `-=`                      | `var -= expr`                                           | 算术减法并赋值                           | `SubEq`       |
| `->`                      | `fn(...) -> type`, <code>&vert;...&vert; -> type</code> | 函数和闭包返回类型                       |               |
| `.`                       | `expr.ident`                                            | 成员访问                                 |               |
| `/`                       | `expr / expr`                                           | 算术除法                                 | `Div`         |
| `/=`                      | `var /= expr`                                           | 算术除法并赋值                           | `DivEq`       |
| `:`                       | `pat: type`, `ident: type`                              | 约束                                     |               |
| `:`                       | `ident: expr`                                           | 结构体字段初始化器                       |               |
| `;`                       | `expr;`                                                 | 语句和项终止符                           |               |
| `<`                       | `expr < expr`                                           | 小于比较                                 | `PartialOrd`  |
| `<=`                      | `expr <= expr`                                          | 小于等于比较                             | `PartialOrd`  |
| `=`                       | `var = expr`                                            | 赋值                                     |               |
| `==`                      | `expr == expr`                                          | 相等比较                                 | `PartialEq`   |
| `=>`                      | `pat => expr`                                           | 匹配分支语法的一部分                     |               |
| `>`                       | `expr > expr`                                           | 大于比较                                 | `PartialOrd`  |
| `>=`                      | `expr >= expr`                                          | 大于等于比较                             | `PartialOrd`  |
| `^`                       | `expr ^ expr`                                           | 按位异或 (XOR)                           | `BitXor`      |
| <code>&vert;</code>       | <code>expr &vert; expr</code>                           | 按位或 (OR)                              | `BitOr`       |
| <code>&vert;&vert;</code> | <code>expr &vert;&vert; expr</code>                     | 短路逻辑或 (OR)                          |               |
| `?`                       | expr?                                                   | 错误传播                                 |

<span class="caption">表 B-1: 运算符</span>

## 非运算符符号

以下列表包含所有不用作运算符的符号；也就是说，它们的行为与函数或方法调用不同。

表 B-2 显示了独自出现并在各种位置有效的符号。

| 符号                                    | 解释                                      |
| --------------------------------------- | ----------------------------------------- |
| `..._u8`, `..._usize`, `..._bool`, etc. | 特定类型的数字字面量                      |
| `"..."`                                 | 字符串字面量                              |
| `'...'`                                 | 短字符串，最多 31 个 ASCII 字符           |
| `_`                                     | “忽略”模式绑定                            |

<span class="caption">表 B-2: 独立语法</span>

表 B-3 显示了用于模块层次路径上下文中访问项的符号。

| 符号                 | 解释                                             |
| -------------------- | ------------------------------------------------ |
| `ident::ident`       | 命名空间路径                                     |
| `super::path`        | 当前模块父级相对路径                             |
| `trait::method(...)` | 通过命名定义方法的 trait 来消除方法调用的歧义    |

<span class="caption">表 B-3: 路径相关语法</span>

表 B-4 显示了用于指定泛型类型参数上下文中的符号。

| 符号                           | 解释                                                                                    |
| ------------------------------ | --------------------------------------------------------------------------------------- |
| `path<...>`                    | 指定类型中的泛型类型参数 (例如 `Array<u8>`)                                             |
| `path::<...>`, `method::<...>` | 指定表达式中泛型类型、函数或方法的参数；通常被称为 turbofish                            |
| `fn ident<...> ...`            | 定义泛型函数                                                                            |
| `struct ident<...> ...`        | 定义泛型结构体                                                                          |
| `enum ident<...> ...`          | 定义泛型枚举                                                                            |
| `impl<...> ...`                | 定义泛型实现                                                                            |

<span class="caption">表 B-4: 泛型</span>

表 B-5 显示了用于在项上指定属性的上下文中的符号。

| 符号                                 | 解释                                                                                                          |
| ------------------------------------ | ------------------------------------------------------------------------------------------------------------- |
| `#[derive(...)]`                     | 自动为类型实现 trait                                                                                          |
| `#[inline]`                          | 给编译器的提示，允许内联注释的函数                                                                            |
| `#[inline(always)]`                  | 给编译器的提示，系统地内联注释的函数                                                                          |
| `#[inline(never)]`                   | 给编译器的提示，从不内联注释的函数                                                                            |
| `#[must_use]`                        | 给编译器的提示，必须使用函数或特定返回类型的返回值                                                            |
| `#[generate_trait]`                  | 自动为 impl 生成 trait                                                                                        |
| `#[available_gas(...)]`              | 设置执行函数可用的最大 gas 数量                                                                               |
| `#[panic_with('...', wrapper_name)]` | 为注释函数创建一个包装器，如果函数返回 `None` 或 `Err`，则该包装器将 panic，并使用给定的数据作为 panic 错误   |
| `#[test]`                            | 将函数描述为测试函数                                                                                          |
| `#[cfg(...)]`                        | 配置属性，特别用于通过 `#[cfg(test)]` 配置 `tests` 模块                                                       |
| `#[should_panic]`                    | 指定测试函数必须 panic                                                                                        |
| `#[starknet::contract]`              | 定义 Starknet 智能合约                                                                                        |
| `#[starknet::interface]`             | 定义 Starknet 接口                                                                                            |
| `#[starknet::component]`             | 定义 Starknet 组件                                                                                            |
| `#[starknet::embeddable]`            | 定义隔离的可嵌入实现，可以注入任何智能合约                                                                    |
| `#[embeddable_as(...)]`              | 在组件内定义可嵌入实现                                                                                        |
| `#[storage]`                         | 定义智能合约的存储                                                                                            |
| `#[event]`                           | 定义智能合约中的事件                                                                                          |
| `#[constructor]`                     | 定义智能合约中的构造函数                                                                                      |
| `#[abi(embed_v0)]`                   | 定义 trait 的实现，将 impl 的函数作为合约的入口点公开                                                         |
| `#[abi(per_item)]`                   | 允许单独定义 impl 内部函数的入口点类型                                                                        |
| `#[external(v0)]`                    | 当使用 `#[abi(per_item)]` 时定义外部函数                                                                      |
| `#[flat]`                            | 定义不嵌套的 `Event` 枚举变体，在序列化过程中忽略变体名称，在使用 Starknet 组件时对于可组合性非常有用         |
| `#[key]`                             | 定义索引的 `Event` 枚举字段，允许更有效地查询和过滤事件                                                       |

<span class="caption">表 B-5: 属性</span>

表 B-6 显示了用于调用或定义宏的上下文中的符号。

| 符号                       | 解释                                                       |
| -------------------------- | ---------------------------------------------------------- |
| `print!`                   | 内联打印                                                   |
| `println!`                 | 在新行打印                                                 |
| `array!`                   | 实例化并填充数组                                           |
| `panic!`                   | 调用 `panic` 函数并允许提供超过 31 个字符的错误消息        |
| `assert!`                  | 评估布尔值，如果为 `false` 则 panic                        |
| `assert_eq!`               | 评估相等性，如果不相等则 panic                             |
| `assert_ne!`               | 评估相等性，如果相等则 panic                               |
| `assert_lt!`               | 评估比较，如果大于或等于则 panic                           |
| `assert_le!`               | 评估比较，如果大于则 panic                                 |
| `assert_gt!`               | 评估比较，如果小于或等于则 panic                           |
| `assert_ge!`               | 评估比较，如果小于则 panic                                 |
| `format!`                  | 格式化字符串并返回包含内容的 `ByteArray`                   |
| `write!`                   | 在格式化程序中写入格式化字符串                             |
| `writeln!`                 | 在格式化程序中在新行写入格式化字符串                       |
| `get_dep_component!`       | 从组件内状态的快照返回请求的组件状态                       |
| `get_dep_component_mut!`   | 从组件内状态的引用返回请求的组件状态                       |
| `component!`               | 在 Starknet 合约中使用的宏，用于将组件嵌入合约             |

<span class="caption">表 B-6: 宏</span>

表 B-7 显示了创建注释的符号。

| 符号   | 解释     |
| ------ | -------- |
| `//`   | 行注释   |

<span class="caption">表 B-7: 注释</span>

表 B-8 显示了使用元组的上下文中的符号。

| 符号              | 解释                                                       |
| ----------------- | ---------------------------------------------------------- |
| `()`              | 空元组（又名单元 unit），即是字面量也是类型                |
| `(expr)`          | 括号表达式                                                 |
| `(expr,)`         | 单元素元组表达式                                           |
| `(type,)`         | 单元素元组类型                                             |
| `(expr, ...)`     | 元组表达式                                                 |
| `(type, ...)`     | 元组类型                                                   |
| `expr(expr, ...)` | 函数调用表达式；也用于初始化元组 `struct` 和元组 `enum` 变体 |

<span class="caption">表 B-8: 元组</span>

表 B-9 显示了使用大括号的上下文。

| 上下文       | 解释            |
| ------------ | --------------- |
| `{...}`      | 块表达式        |
| `Type {...}` | `struct` 字面量 |

<span class="caption">表 B-9: 大括号</span>
